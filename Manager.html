<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ورود به سیستم</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- انیمیشن‌ها --- */
        @keyframes animateCloud1 { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(0%, 0%) rotate(360deg); } }
        @keyframes animateCloud2 { from { transform: translate(0, 0) rotate(0deg); } to { transform: translate(-40%, -40%) rotate(360deg); } }
        @keyframes shake { 10%, 90% { transform: translateX(-1px); } 20%, 80% { transform: translateX(2px); } 30%, 50%, 70% { transform: translateX(-4px); } 40%, 60% { transform: translateX(4px); } }

        /* --- استایل‌های عمومی و ساختاری --- */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Vazirmatn', sans-serif;
        }
        body { background-color: #0c0f14; }
        .page-container { width: 100%; height: 100%; position: relative; }

        /* === صفحه لاگین === */
        #login-page {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%; height: 100%;
            position: relative;
            overflow: hidden;
        }
        #login-page::before, #login-page::after {
            content: ''; position: fixed; top: 50%; left: 50%;
            width: 200vw; height: 200vh; z-index: -1;
        }
        #login-page::before {
            background: radial-gradient(circle at 20% 30%, hsla(210, 50%, 80%, 0.15), transparent 40%);
            animation: animateCloud1 60s linear infinite alternate;
        }
        #login-page::after {
            background: radial-gradient(circle at 80% 70%, hsla(210, 50%, 80%, 0.1), transparent 35%);
            animation: animateCloud2 80s linear infinite alternate;
        }
        
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
        }
        
        .login-title {
            color: rgba(255, 255, 255, 0.9);
            font-weight: 700;
            font-size: 2rem;
            direction: ltr;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .login-form {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px 35px 40px 35px;
            width: 100%; max-width: 400px;
            display: flex; flex-direction: column; align-items: center;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        
        .profile-avatar {
            width: 100px; height: 100px; border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 25px; overflow: hidden;
        }
        .profile-avatar img { width: 100%; height: 100%; object-fit: cover; }
        
        .input-group {
            position: relative; width: 100%;
            margin-bottom: 20px; direction: ltr;
        }
        .input-group svg {
            position: absolute; left: 15px; top: 50%; transform: translateY(-50%);
            width: 20px; height: 20px; fill: rgba(255, 255, 255, 0.6);
            pointer-events: none;
        }
        
        .input-field {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff; font-size: 16px; font-family: 'Vazirmatn', sans-serif;
            transition: all 0.3s ease;
            box-sizing: border-box;
            padding-block: 15px;
            padding-inline-start: 50px;
            padding-inline-end: 15px;
        }
        .input-field:focus {
            outline: none;
            border-color: rgba(46, 204, 113, 0.8);
            box-shadow: 0 0 10px 2px rgba(46, 204, 113, 0.4);
        }
        
        select.input-field {
            -webkit-appearance: none; -moz-appearance: none; appearance: none;
            cursor: pointer;
        }
        select.input-field:invalid { color: rgba(255, 255, 255, 0.5); }
        
        #login-button {
            width: 100%; padding: 15px; background-color: #27ae60;
            border: none; border-radius: 10px; color: white; font-size: 18px;
            font-weight: 700; cursor: pointer;
            transition: all 0.3s ease;
        }
        #login-button:hover {
            background-color: #2ecc71;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
        }
        
        .error-message { color: #e74c3c; margin-top: 15px; height: 20px; font-weight: 700; }

        /* === صفحه داشبورد === */
        #dashboard-page {
            display: none;
            width: 100%; height: 100%;
            background-color: #121212; color: #e0e0e0;
            transition: background-color 0.3s, color 0.3s;
            overflow-y: auto;
        }
        #dashboard-page.light-mode { background-color: #f4f7f6; color: #333333; }
        .navbar {
            background-color: #1e2732; padding: 0 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.5);
            display: flex; justify-content: space-between; align-items: center;
            height: 60px; position: sticky; top: 0; z-index: 1001;
        }
        .nav-menu, .dropdown-menu { list-style: none; margin: 0; padding: 0; }
        .nav-menu { display: flex; }
        .nav-item { position: relative; }
        .nav-link {
            display: block; color: #ecf0f1; text-decoration: none;
            padding: 20px 25px; font-size: 16px; cursor: pointer; transition: background-color 0.3s;
        }
        .nav-link:hover { background-color: #34495e; }
        .dropdown-toggle::after { content: ' ▼'; font-size: 10px; margin-right: 5px; }
        .dropdown-menu {
            display: none; position: absolute; top: 100%; right: 0;
            background-color: #2c3e50; color: #ecf0f1; min-width: 220px;
            border-radius: 0 0 8px 8px; box-shadow: 0 8px 16px rgba(0,0,0,0.5); z-index: 1000;
        }
        #dashboard-page.light-mode .dropdown-menu { background-color: #ffffff; color: #333; box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
        .dropdown-menu.show { display: block; }
        .dropdown-item a {
            display: block; padding: 12px 20px; color: inherit; text-decoration: none;
            font-size: 15px; transition: background-color 0.3s;
        }
        .dropdown-item a:hover { background-color: #4a6fa5; }
        #dashboard-page.light-mode .dropdown-item a:hover { background-color: #f1f1f1; }
        .main-content {
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; min-height: calc(100vh - 60px); padding: 20px;
        }
        .main-content h1 { font-size: 3rem; margin-bottom: 10px; }
        .sub-heading {
            font-size: 1.1rem; font-weight: 700; color: #a0a0a0;
            margin-top: 0; margin-bottom: 25px; direction: ltr;
        }
        #dashboard-page.light-mode .sub-heading { color: #6c757d; }
        #datetime-container {
            display: flex; align-items: center; gap: 20px;
            font-size: 1.5rem; margin-bottom: 30px; direction: ltr;
        }
        .separator { width: 2px; height: 65px; background-color: #a0a0a0; opacity: 0.5; }
        #dashboard-page.light-mode .separator { background-color: #6c757d; }
        #shamsi-date-block {
            display: flex; flex-direction: column;
            line-height: 1.4; align-items: center; text-align: center;
        }
        .developer-info { font-size: 1.1rem; color: #a0a0a0; direction: ltr; }
        #dashboard-page.light-mode .developer-info { color: #6c757d; }
        .theme-switcher { cursor: pointer; background: none; border: none; padding: 10px; }
        .theme-switcher svg { width: 24px; height: 24px; fill: #ffffff; }
        .theme-switcher .sun-icon { display: none; }
        #dashboard-page.light-mode .theme-switcher .moon-icon { display: none; }
        #dashboard-page.light-mode .theme-switcher .sun-icon { display: block; }
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); z-index: 2000; justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #333; color: #e0e0e0; padding: 30px; border-radius: 8px;
            text-align: center; width: 90%; max-width: 400px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        #dashboard-page.light-mode .modal-content { background-color: #ffffff; color: #555; }
        .modal-content h3 { margin-top: 0; color: inherit; }
        .modal-button {
            padding: 10px 25px; border: none; border-radius: 5px;
            cursor: pointer; font-size: 16px; margin: 0 10px;
        }
        #confirm-open-link { background-color: #27ae60; color: white; }
        #cancel-open-link { background-color: #e74c3c; color: white; }
    </style>
</head>
<body>

    <div id="login-page" class="page-container">
        <div class="login-container">
            <h2 class="login-title">Please Log In</h2>
            <form class="login-form">
                <div class="profile-avatar">
                    <img src="profile.jpg" alt="تصویر پروفایل">
                </div>
                <div class="input-group">
                    <svg viewBox="0 0 24 24"><path d="M12,12A5,5,0,1,0,7,7,5,5,0,0,0,12,12Zm0,2c-2.7,0-8,1.3-8,4v2H20V18C20,15.3,14.7,14,12,14Z"/></svg>
                    <select id="role-select" class="input-field" required>
                        <option value="" disabled selected>Select Your Role</option>
                        <option value="Manager">Manager</option>
                        <option value="User">User</option>
                    </select>
                </div>
                <div class="input-group">
                    <svg viewBox="0 0 24 24"><path d="M18,8H17V6A5,5,0,0,0,7,6V8H6A2,2,0,0,0,4,10V20A2,2,0,0,0,6,22H18A2,2,0,0,0,20,20V10A2,2,0,0,0,18,8ZM9,6a3,3,0,0,1,6,0V8H9Z"/></svg>
                    <input type="password" id="password" class="input-field" placeholder="Password" required>
                </div>
                <p id="login-error" class="error-message"></p>
                <button type="submit" id="login-button">ورود</button>
            </form>
        </div>
    </div>

    <div id="dashboard-page" class="page-container">
        <nav class="navbar">
            <ul class="nav-menu">
                <li class="nav-item"><a href="#" class="nav-link">صفحه اصلی</a></li>
                <li class="nav-item" id="management-nav-item">
                    <a class="nav-link dropdown-toggle" id="management-menu">مدیریت</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="#" id="open-management-modal">مدیریت چک</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۱</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۲</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۳</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۴</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۵</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۶</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۷</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۸</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۹</a></li>
                        <li class="dropdown-item"><a href="#">مدیریت ۱۰</a></li>
                    </ul>
                </li>
            </ul>
            <button class="theme-switcher" id="theme-toggle" title="تغییر تم">
                <svg class="moon-icon" viewBox="0 0 24 24"><path d="M12 11.807A9.002 9.002 0 0 1 12 3a9 9 0 0 0 0 18 9.002 9.002 0 0 1 0-9.193z"/></svg>
                <svg class="sun-icon" viewBox="0 0 24 24"><path d="M12 9c-1.657 0-3 1.343-3 3s1.343 3 3 3 3-1.343 3-3-1.343-3-3-3zM4.222 5.636l1.414-1.414L7.05 5.636 5.636 7.05 4.222 5.636zm14.142 14.142l1.414-1.414L21.192 17 19.778 18.414l-1.414-1.414zm-15.556 0l1.414 1.414L5.636 17 4.222 18.414 2.808 17l1.414-1.414zM12 5V2h-1v3h1zm0 17v-3h-1v3h1zm-7-9H2v-1h3v1zm17 0h-3v-1h3v1z"/></svg>
            </button>
        </nav>
        <div class="main-content">
            <h1>Welcome</h1>
            <p class="sub-heading">Use the menu to navigate to the desired section.</p>
            <div id="datetime-container">
                <span id="time-display"></span>
                <div class="separator"></div>
                <div id="shamsi-date-block">
                    <span id="shamsi-day"></span>
                    <span id="shamsi-month"></span>
                    <span id="shamsi-year"></span>
                </div>
            </div>
            <p class="developer-info">Developer: Ali Asemani</p>
        </div>
        <div id="my-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>انتقال به سرویس مدیریت چک</h3>
                <p>شما در حال هدایت به بخش مدیریت چک هستید. این صفحه در یک تب جدید باز خواهد شد.</p>
                <button id="confirm-open-link" class="modal-button">ادامه</button>
                <button id="cancel-open-link" class="modal-button">انصراف</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loginPage = document.getElementById('login-page');
            const dashboardPage = document.getElementById('dashboard-page');
            const loginForm = document.querySelector('.login-form');
            const roleSelect = document.getElementById('role-select');
            const passwordInput = document.getElementById('password');
            const loginError = document.getElementById('login-error');
            let clockInterval;
            let dashboardInitialized = false;

            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const username = roleSelect.value;
                const password = passwordInput.value;
                let userRole = null;

                if (username === 'Manager' && password === '1610') {
                    userRole = 'manager';
                } else if (username === 'User' && password === '1234') {
                    userRole = 'user';
                }

                if (userRole) {
                    loginPage.style.display = 'none';
                    dashboardPage.style.display = 'block';
                    if (!dashboardInitialized) {
                        setupDashboardScripts(userRole);
                        dashboardInitialized = true;
                    } else {
                        const managementNavItem = document.getElementById('management-nav-item');
                        managementNavItem.style.display = userRole === 'manager' ? 'list-item' : 'none';
                    }
                } else {
                    loginError.textContent = 'Role or Password incorrect';
                    loginForm.style.animation = 'shake 0.5s';
                    setTimeout(() => { loginForm.style.animation = ''; }, 500);
                }
            });
            
            function setupDashboardScripts(role) {
                const managementNavItem = document.getElementById('management-nav-item');
                managementNavItem.style.display = role === 'manager' ? 'list-item' : 'none';

                const dropdownToggle = document.getElementById('management-menu');
                if (dropdownToggle) {
                    const dropdownMenu = dropdownToggle.nextElementSibling;
                    dropdownToggle.addEventListener('click', (e) => {
                        e.stopPropagation();
                        dropdownMenu.classList.toggle('show');
                    });
                }
                window.addEventListener('click', () => {
                    const openDropdown = document.querySelector('.dropdown-menu.show');
                    if (openDropdown) { openDropdown.classList.remove('show'); }
                });

                const modal = document.getElementById('my-modal');
                const openModalButton = document.getElementById('open-management-modal');
                if (openModalButton) {
                    openModalButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        modal.style.display = 'flex';
                        const openDropdown = document.querySelector('.dropdown-menu.show');
                        if (openDropdown) openDropdown.classList.remove('show');
                    });
                }
                
                const confirmButton = document.getElementById('confirm-open-link');
                const cancelButton = document.getElementById('cancel-open-link');
                cancelButton.addEventListener('click', () => modal.style.display = 'none');
                confirmButton.addEventListener('click', () => {
                    window.open("https://script.google.com/macros/s/AKfycbwhgd1ZJnTlLbEozNf_ucSkq_3JckCf1PnEMO0zaeSI-7EGFpBXRDfrqBIZFt4AGA/exec", '_blank', 'noopener,noreferrer');
                    modal.style.display = 'none';
                });
                modal.addEventListener('click', (e) => { if (e.target === modal) modal.style.display = 'none'; });

                const themeToggleButton = document.getElementById('theme-toggle');
                const dashboardBody = document.getElementById('dashboard-page');
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'light') { dashboardBody.classList.add('light-mode'); }
                themeToggleButton.addEventListener('click', () => {
                    dashboardBody.classList.toggle('light-mode');
                    localStorage.setItem('theme', dashboardBody.classList.contains('light-mode') ? 'light' : 'dark');
                });
                
                const timeDisplay = document.getElementById('time-display');
                const shamsiDay = document.getElementById('shamsi-day');
                const shamsiMonth = document.getElementById('shamsi-month');
                const shamsiYear = document.getElementById('shamsi-year');
                const shamsiFormatter = new Intl.DateTimeFormat('fa-IR', { year: 'numeric', month: 'long', day: 'numeric' });
                function updateClock() {
                    const now = new Date();
                    timeDisplay.textContent = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true }).replace(' ', '');
                    const dateParts = shamsiFormatter.formatToParts(now);
                    shamsiDay.textContent = dateParts.find(p => p.type === 'day').value;
                    shamsiMonth.textContent = dateParts.find(p => p.type === 'month').value;
                    shamsiYear.textContent = dateParts.find(p => p.type === 'year').value;
                }
                updateClock();
                if (clockInterval) clearInterval(clockInterval);
                clockInterval = setInterval(updateClock, 1000);
            }
        });
    </script>
</body>
</html>
